@model Minible5.Models.ViewModels.Articulos.EditArticulosViewModels

@{
    ViewBag.Title = "Detalles Tipos de Movimientos";
    ViewBag.pTitle = "Detalles Tipos de Movimientos";
    ViewBag.pageTitle = "Detalles Tipos de Movimientos";
    Layout = "~/Views/_Shared/_Layout.cshtml";

    List<SelectListItem> itemsFamilias = (List<SelectListItem>)ViewBag.itemsFamilias;
    List<SelectListItem> itemsMarcas = (List<SelectListItem>)ViewBag.itemsMarcas;
    List<SelectListItem> itemsTipo = (List<SelectListItem>)ViewBag.itemsTipo;
    List<SelectListItem> itemsMedidas = (List<SelectListItem>)ViewBag.itemsMedidas;
    List<SelectListItem> itemsProveedores = (List<SelectListItem>)ViewBag.itemsProveedores;
    List<SelectListItem> itemsArticulogenerico = (List<SelectListItem>)ViewBag.itemsArticulogenerico;
}

<!-- plugin css -->
<link href="~/assets/libs/select2/css/select2.min.css" rel="stylesheet" type="text/css" />

<!-- Sweet Alert-->
<link href="~/assets/libs/sweetalert2/sweetalert2.min.css" rel="stylesheet" type="text/css" />
<!-- dropzone css -->
<link href="~/assets/libs/dropzone/min/dropzone.min.css" rel="stylesheet" type="text/css" />



<!-- Font Awesome -->
<link rel="stylesheet" href="~/assets/LTE/bower_components/font-awesome/css/font-awesome.min.css">

<!-- daterange picker -->
<link rel="stylesheet" href="~/assets/LTE/bower_components/bootstrap-daterangepicker/daterangepicker.css">

<!-- bootstrap datepicker -->
<link rel="stylesheet" href="~/assets/LTE/bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">

<!-- iCheck for checkboxes and radio inputs -->
<link rel="stylesheet" href="~/assets/LTE/plugins/iCheck/all.css">

<!-- Bootstrap time Picker -->
<link rel="stylesheet" href="~/assets/LTE/plugins/timepicker/bootstrap-timepicker.min.css">

<!-- Theme style -->
<link rel="stylesheet" href="~/assets/LTE/dist/css/AdminLTE.min.css">

<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="p-4 border-top">


                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">Encabezado</h3>

                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i></button>
                        </div>
                    </div>
                    <div class="box-body">

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.idInternoFamilias)
                                    @Html.DropDownListFor(d => d.idInternoFamilias, itemsFamilias, "", new { @class = "form-control select2", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.idInternoMarcas)
                                    @Html.DropDownListFor(d => d.idInternoMarcas, itemsMarcas, "", new { @class = "form-control select2", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->

                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.idArticulo)
                                    @Html.TextBoxFor(d => d.idArticulo, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.nombreArticulo)
                                    @Html.TextBoxFor(d => d.nombreArticulo, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->


                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.tipo)
                                    @Html.DropDownListFor(d => d.tipo, itemsTipo, "", new { @class = "form-control select2", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.idInternoMedidas)
                                    @Html.DropDownListFor(d => d.idInternoMedidas, itemsMedidas, "", new { @class = "form-control select2", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->

                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.codigoBarras)
                                    @Html.TextBoxFor(d => d.codigoBarras, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.idInternoProveedores)
                                    @Html.DropDownListFor(d => d.idInternoProveedores, itemsProveedores, "", new { @class = "form-control select2", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->


                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.idinternoArticuloDetalleGenerico)
                                    @Html.DropDownListFor(d => d.idinternoArticuloDetalleGenerico, itemsArticulogenerico, "", new { @class = "form-control select2", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">

                                    @Html.CheckBoxFor(d => d.statusMenudeo, new { @class = "flat-red", @disabled = "disabled" })
                                    @Html.LabelFor(d => d.statusMenudeo, new { @class = "col-form-label" })

                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->


                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.precioVenta_1_1)
                                    @Html.TextBoxFor(d => d.precioVenta_1_1, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.precioVenta_2_2)
                                    @Html.TextBoxFor(d => d.precioVenta_2_2, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->

                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.porcentajeDescuento1_1)
                                    @Html.TextBoxFor(d => d.porcentajeDescuento1_1, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.porcentajeDescuento2_2)
                                    @Html.TextBoxFor(d => d.porcentajeDescuento2_2, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->

                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(d => d.porcentajeDescuento3_3)
                                    @Html.TextBoxFor(d => d.porcentajeDescuento3_3, new { @class = "form-control", @disabled = "disabled" })
                                </div>
                            </div>
                            <!-- /.col -->
                          
                        </div>
                        <!-- /.row -->

                        <br />
                        <div class="row">
                            <div class="text-center">
                                 <img src="@Model.foto" class="rounded" alt="" width="300" height="168">
                            </div>
                            <!-- /.col -->                            
                        </div>
                        <!-- /.row -->


                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->


                <br />
                <div class="box box-success">
                    <div class="box-header with-border">
                        <h3 class="box-title">Detalle</h3>
                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i></button>
                        </div>
                    </div>

                    <div class="box-body">
                        
                            <table class="table table-centered datatable dt-responsive nowrap table-card-list" id="articulosTable"
                                   style="border-collapse: collapse; border-spacing: 0 12px; width: 50%; ">
                                <thead>
                                    <tr class="bg-transparent">
                                        <th>Codigo Bodega</th>
                                        <th>Bodega</th>
                                        <th>Ubicacion</th>
                                        <th>Ultima Fecha Venta</th>
                                        <th>Ultima Fecha Compra</th>
                                        <th>Fecha Alta</th>
                                        <th>Unidades Iniciales</th>
                                        <th>Unidades Entrantes</th>
                                        <th>Unidades Salientes</th>
                                        <th>Costo Inicial</th>
                                        <th>Costo Entradas</th>
                                        <th>Costo Salida</th>
                                        <th>Doc. Fecha Ultima Compra 1</th>
                                        <th>Doc. Fecha Ultima Compra 2</th>
                                        <th>Doc. Fecha Ultima Compra 3</th>
                                        <th>Valor Ultima Compra 1</th>
                                        <th>Valor Ultima Compra 2</th>
                                        <th>Valor Ultima Compra 3</th>
                                        <th>Maximo</th>
                                        <th>Minimo</th>

                                    </tr>

                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        
                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->

            </div>
        </div>
    </div>
</div>
<!-- end row -->


<div id="hiddenEmpresas"></div>

<div class="row mb-4">
    <div class="col text-end">
        <a href="@Url.Action("Index", "articulosinvs")" class="btn btn-primary"> <i class="uil-arrow-left font-size-18"></i> Regresar </a>
        <a href="@Url.Action("Edit", "articulosinvs", new { id = Model.idInternoArticulos})" class="btn btn btn-success"> <i class="uil uil-pen font-size-18"></i> Editar </a>
        <a href="javascript:void(0);" onclick="@("Delete("+Model.idInternoArticulos )@(")")" class="btn btn-danger"><i class="uil uil-trash-alt font-size-18"></i>Elimanar</a>
    </div> <!-- end col -->
</div> <!-- end row-->
<!-- JAVASCRIPT -->
<script src="~/assets/libs/jquery/jquery.min.js"></script>

<!-- Required datatable js -->
<script src="~/assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="~/assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>

<!-- Responsive examples -->
<script src="~/assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="~/assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>


<script src="~/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="~/assets/libs/metismenu/metisMenu.min.js"></script>
<script src="~/assets/libs/simplebar/simplebar.min.js"></script>
<script src="~/assets/libs/node-waves/waves.min.js"></script>
<script src="~/assets/libs/waypoints/lib/jquery.waypoints.min.js"></script>
<script src="~/assets/libs/jquery.counterup/jquery.counterup.min.js"></script>

<script src="~/assets/js/pages/form-validation.init.js"></script>
<script src="~/assets/libs/parsleyjs/parsley.min.js"></script>

<!-- Sweet Alerts js -->
<script src="~/assets/libs/sweetalert2/sweetalert2.min.js"></script>

<!-- dropzone plugin -->
<script src="~/assets/libs/dropzone/min/dropzone.min.js"></script>

<!-- init js -->
<script src="~/assets/js/pages/ecommerce-add-product.init.js"></script>
<script src="~/assets/js/app.js"></script>





<!-- Bootstrap 3.3.7 -->
<script src="~/assets/LTE/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- Select2 -->
<script src="~/assets/LTE/bower_components/select2/dist/js/select2.full.min.js"></script>
<!-- InputMask -->
<script src="~/assets/LTE/plugins/input-mask/jquery.inputmask.js"></script>
<script src="~/assets/LTE/plugins/input-mask/jquery.inputmask.date.extensions.js"></script>
<script src="~/assets/LTE/plugins/input-mask/jquery.inputmask.extensions.js"></script>
<!-- date-range-picker -->
<script src="~/assets/LTE/bower_components/moment/min/moment.min.js"></script>
<script src="~/assets/LTE/bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- bootstrap datepicker -->
<script src="~/assets/LTE/bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

<!-- bootstrap time picker -->
<script src="~/assets/LTE/plugins/timepicker/bootstrap-timepicker.min.js"></script>
<!-- SlimScroll -->
<!-- iCheck 1.0.1 -->
<script src="~/assets/LTE/plugins/iCheck/icheck.min.js"></script>
<!-- FastClick -->
<!-- AdminLTE App -->
<script src="~/assets/LTE/dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->


@section scripts{
    <script>

    $(document).ready(function () {

        usersTable2 = $("#articulosTable").DataTable({
            "language": {
                "lengthMenu": "Mostrando _MENU_ArticulosDetalle",
                "zeroRecords": "No encontrado, lo sentimos   :'(",
                "info": "Página _PAGE_ de _PAGES_",
                "infoEmpty": "No existen registros",
                "infoFiltered": "(filtrado de _MAX_ registros totales)",
                'loadingRecords': '<div class="spinner"><i class="mdi mdi-spin mdi-loading spin-icon"></i></div>',
                'processing': '<div class="spinner"><i class="mdi mdi-spin mdi-loading spin-icon"></i></div>',

                "paginate": {
                    "first": "Primero",
                    "last": "Último",
                    "next": "Siguiente",
                    "previous": "Anterior"
                }
            },
            "search": "Buscar:",
            "processing": true,
            "serverSide": true,
            "ajax": {
                "url": "@Url.Content("~/articulosinvs/GetArticulosDetalle/?id=" + Model.idInternoArticulos)",
                "type": "POST",
                "datatype": "json"
            },
            "pageLength": 10,
            "filter": true,
            "data": null,
            "columns": [

                { "data": "idBodega", "name": "idBodega" },
                { "data": "descripcionBodega", "name": "descripcionBodega" },
                { "data": "ubicacion", "name": "ubicacion" },
                { "data": "ultimaFechaVenta", "name": "ultimaFechaVenta" },
                { "data": "ultimaFechaCompra", "name": "ultimaFechaCompra" },
                { "data": "fechaAlta", "name": "fechaAlta" },
                { "data": "unidadesIniciales", "name": "unidadesIniciales" },
                { "data": "unidadesEntrantes", "name": "unidadesEntrantes" },
                { "data": "unidadesSalientes", "name": "unidadesSalientes" },
                { "data": "costoInicial_Q", "name": "costoInicial_Q" },
                { "data": "costoEntradas_Q", "name": "costoEntradas_Q" },
                { "data": "costoSalidas_Q", "name": "costoSalidas_Q" },
                { "data": "docfechaultcomp1", "name": "docfechaultcomp1" },
                { "data": "docfechaultcomp2", "name": "docfechaultcomp2" },
                { "data": "docfechaultcomp3", "name": "docfechaultcomp3" },
                { "data": "valorultcomp1", "name": "valorultcomp1" },
                { "data": "valorultcomp2", "name": "valorultcomp2" },
                { "data": "valorultcomp3", "name": "valorultcomp3" },
                { "data": "maximo", "name": "maximo" },
                { "data": "minimo", "name": "minimo" }


            ],            
            "scrollX": true

        })

        });

        $(function () {


            //iCheck for checkbox and radio inputs
            $('input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({
                checkboxClass: 'icheckbox_minimal-blue',
                radioClass: 'iradio_minimal-blue'
            })
            //Red color scheme for iCheck
            $('input[type="checkbox"].minimal-red, input[type="radio"].minimal-red').iCheck({
                checkboxClass: 'icheckbox_minimal-red',
                radioClass: 'iradio_minimal-red'
            })
            //Flat red color scheme for iCheck
            $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-green'
            })

        });


        function deleteData(id) {
             return $.ajax({
                type: "POST",
                url: '@Url.Action("Delete", "articulosinvs")/?id=' + id,
                success: function (data) {
                    if (data.success) {
                        //usersTable.ajax.reload();
                    }
                }
            });
        }

        function Delete(id) {
            Swal.fire({
                title: "Estas seguro?", text: "No hay forma de rehacer esta función!", icon: "warning", showCancelButton: !0, confirmButtonText: "Si, Eliminar!", cancelButtonText: "No, Cancelar!", confirmButtonClass: "btn btn-success mt-2", cancelButtonClass: "btn btn-danger ms-2 mt-2", buttonsStyling: !1
            }).then(async function (t) {
                if (t.value) {
                    //SI CONFIRMA
                    await deleteData(id)

                    Swal.fire({
                        icon: 'success',
                        title: 'Eliminado!',
                        showConfirmButton: false,
                        text: "El articulo ha sido eliminado.",
                        timer: 2000
                    })

                    setTimeout(function () { window.location.href = "Index"; }, 2500);

                } else {
                    //SI CANCELA
                    t.dismiss === Swal.DismissReason.cancel && Swal.fire({ title: "Cancelado", text: "El articulo no se ha eliminado :)", icon: "error" })
                }
            })
        }



    </script>

}